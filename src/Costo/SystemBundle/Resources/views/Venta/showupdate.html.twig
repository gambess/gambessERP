{% extends 'CostoSystemBundle::layout.html.twig' %}
{% block content_header %}
        {% javascripts
            '@CostoSystemBundle/Resources/public/js/jquery-1.7.2.min.js'
            '@CostoSystemBundle/Resources/public/js/jquery-ui-1.8.21.custom.min.js'
            '@CostoSystemBundle/Resources/public/js/ui/i18n/jquery.ui.datepicker-es.js'
            '@CostoSystemBundle/Resources/public/js/details.js'
            '@CostoSystemBundle/Resources/public/js/jquery-te-1.3.5.min.js'
            '@CostoSystemBundle/Resources/public/js/jquery.snippet.min.js'
            '@CostoSystemBundle/Resources/public/js/jquery.modal.min.js'
            output='js/compiled/showupdate.js'
         %}
        <script type="text/javascript" src="{{ asset( asset_url) }}"></script>
        {% endjavascripts %}
                <ul id="menu">
                    {% block content_header_more %}
                        IR A:
                        <li><a class="symfony-button-green" href="{{ path('_homepage') }}">Principal</a></li>
                        <li><a class="symfony-button-green" href="{{ path('index_cuenta') }}">Cuentas</a></li>
                        <li><a class="symfony-button-green"  href="{{ path('index_gasto') }}">Gastos</a></li>
                        <li><a class="symfony-button-green" href="{{ path('index_venta') }}">Ventas</a></li>
                    {% endblock %}
                </ul>
                <div style="clear: both"></div>
{% endblock %}
{% block title %}Agregar Desgloce de Ventas del día{% endblock %}
{% block content %}
<h1><center>{{ block('title') }}</center></h1>
<br />
<p align="center">
        <a class="symfony-button-green" href="{{ path('new_venta') }}">
            Crear Nueva Venta
        </a>
        <a class="symfony-button-green" href="{{ path('index_venta') }}">
            Volver al Listado de Ventas
        </a>
</p>
<br />
<form action="{{ path('update_venta', { 'id': form.vars.value.id }) }}" method="post" {{ form_enctype(form) }}>
    {{ form_widget (form.id)}}
    <p>
    <center>
        <div class="symfony-form-row">
                <div class="symfony-form-field">
                {{ form_widget (form.fecha)}}
                {% if errors != null %}
                        {% block field_errors %}
                        {% spaceless %}
                            {% if errors|length > 0 %}
                            <ul class="error_list">
                                {% for error in errors %}
                                    <li>{{ error.messageTemplate|trans(error.messageParameters, 'validators') }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        {% endspaceless %}
                        {% endblock field_errors %}
                {% endif %}
            </div>
        </div>
    </center>
    </p>
    <div id="detalles">
        <div class="detalle" data-prototype="{{ form_widget(form.detalleVentas.vars.prototype.fecha_venta)|e }}{{ form_widget(form.detalleVentas.vars.prototype.lugarVenta)|e}}{{ form_widget(form.detalleVentas.vars.prototype.ventaForma)|e }}{{ form_widget(form.detalleVentas.vars.prototype.total_venta)|e }}{{ form_widget(form.detalleVentas.vars.prototype.total_neto_venta)|e}}{{ form_widget(form.detalleVentas.vars.prototype.total_iva_venta)|e }}{{ form_widget(form.detalleVentas.vars.prototype.formaPago)|e }}{% autoescape %}<a href='#modal_$$name$$' class='open_detail' data-id='venta_detalleVentas_$$name$$_descripcion_venta' rel='modal:open'>Añadir Detalle</a><div id='modal_$$name$$' class='modal'>{% endautoescape %}{{ form_widget (form.detalleVentas.vars.prototype.descripcion_venta)|e}}{% autoescape %}</div>{% endautoescape %}{{ form_widget (form.detalleVentas.vars.prototype.id_detalle)|e}}">
           {% for detail in form.detalleVentas %}
                <div id="new_detalle_{{loop.index0}}" class="new_detalle">
                    <a class="remove" href="#" dbid="{{ detail.vars.value.IdDetalle}}">X</a>
                    {{ form_widget(detail.fecha_venta) }}
                    {{ form_widget(detail.lugarVenta) }}
                    {{ form_widget(detail.ventaForma) }}
                    {{ form_widget(detail.total_venta) }}
                    {{ form_widget(detail.total_neto_venta) }}
                    {{ form_widget(detail.total_iva_venta) }}
                    {{ form_widget(detail.formaPago) }}
                    <a class='open_detail' rel='modal:open' data-id='venta_detalleVentas_{{loop.index0}}_descripcion_venta' href='#modal_{{loop.index0}}'>
                        {% if detail.vars.value.DescripcionVenta is null %}    
                                Añadir Detalle
                        {% else %}
                                Ver ó Modificar Detalle
                        {% endif%}
                    </a>
                        <div id='modal_{{loop.index0}}' class='modal'>
                            {{ form_widget(detail.descripcion_venta) }}
                        </div>
                    {{ form_widget(detail.id_detalle) }}
                </div>
                {% endfor %} 
                     
        </div>
   <div id="totales"> 
    <p>
    <div style="clear: both"></div>
   _______________________________________________________________________________________________________________
    <p>---Totales ------- Neto ------------- IVA ------------ Totales -----</p>
    <div class="documentada">
        Docum.  :
        {{ form_widget (form.total_neto_documentada) }}
        {{ form_widget (form.total_iva_documentada) }}
        {{ form_widget (form.total_documentada) }}
    </div>
    <br />
    <div class="no_documentada">
        No Doc  :
        {{ form_widget (form.total_neto_no_documentada) }}
        {{ form_widget (form.total_iva_no_documentada) }}
        {{ form_widget (form.total_no_documentada) }}
    </div>
    <br />
    <div class="total">
        Total.  :
        {{ form_widget (form.total_neto) }}
        {{ form_widget (form.total_iva) }}
        {{ form_widget (form.total) }}
    </div>
    <br />
    <div class="real">
        Real.  :
        {{ form_widget (form.total_neto_real) }}
        {{ form_widget (form.total_iva_real) }}
        {{ form_widget (form.total_real) }}
    </div>
    </p>
</div>
            <div>{{ form_widget(form._token) }}</div>
<br />
    <p align="right">
        <button class="symfony-button-green" type="submit">Modificar</button>
    </p>
    
</form>
<div id="deletion_venta" title="Confirmación borrar Detalle Venta">
{% include 'CostoSystemBundle:Venta:delete.html.twig'%}
</div>
{% endblock %}